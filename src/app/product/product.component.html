<p-sidebar [visible]="sidebarVisible" (visibleChange)="visibleChange($event)" [modal]="false">
    <ng-template pTemplate="header">Products</ng-template>
    <ng-template pTemplate="content">
        <p-scrollPanel>
            <div class="flex justify-center mb-6">
                <p-button label="Add Product" icon="pi pi-plus" styleClass="p-button-sm"
                    (onClick)="addProduct()"></p-button>
            </div>
            <ng-container [ngTemplateOutlet]="TShowProducts"></ng-container>
        </p-scrollPanel>
    </ng-template>
    <!-- <ng-template pTemplate="footer">Footer Content</ng-template> -->
</p-sidebar>

<ng-template #TShowProducts>
    <ng-container *ngIf="projectService.currentProject">
        <p-accordion [multiple]="true">
            <ng-container *ngFor="let product of projectService.currentProject.products; let index=index">
                <p-accordionTab>
                    <ng-template pTemplate="header">
                        <div class="flex align-items-center">
                            <span class="vertical-align-middle"
                                [ngClass]="product.isActive ? 'text-green-700' : 'text-red-700'">{{index+1}})
                                {{product.name}}</span>
                        </div>
                    </ng-template>
                    <p-table [value]="[product]" styleClass="p-datatable-sm">
                        <ng-template pTemplate="body" let-product>
                            <tr>
                                <td><b>ID</b></td>
                                <td>{{ product.id }}</td>
                            </tr>
                            <tr>
                                <td><b>Company</b></td>
                                <td>{{ product.company }}</td>
                            </tr>
                            <tr>
                                <td><b>Area</b></td>
                                <td>{{ product.area }} m<sup>2</sup></td>
                            </tr>
                            <tr>
                                <td><b>Cells</b></td>
                                <td>{{ product.num_cells }}</td>
                            </tr>
                            <tr>
                                <td><b>Power Peak</b></td>
                                <td>{{ product.power_peak }} W</td>
                            </tr>
                            <tr>
                                <td><b>Orientation</b></td>
                                <td>{{ product.orientation }}</td>
                            </tr>
                            <tr>
                                <td><b>Tilt Angle</b></td>
                                <td>{{ product.tiltAngle }}°</td>
                            </tr>
                            <tr>
                                <td><b>Latitude</b></td>
                                <td>{{ product.lat }}°</td>
                            </tr>
                            <tr>
                                <td><b>Longitude</b></td>
                                <td>{{ product.lng }}°</td>
                            </tr>
                            <tr>
                                <td>Created On</td>
                                <td>{{ getFormattedDateTimeFromTimestamp(product.timestamp )}}</td>
                            </tr>
                            <tr>
                                <td>Status</td>
                                <td>{{ product.isActive ? 'Active' : 'Inactive'}}</td>
                            </tr>
                        </ng-template>
                    </p-table>
                    <div class="flex justify-center">
                        <p-button icon="pi pi-eye" class="mr-6" pTooltip="View On Map" (onClick)="viewOnMap(product)"
                            styleClass="p-button-rounded p-button-outlined"></p-button>
                        <ng-container *ngIf="product.isActive">
                            <p-button icon="pi pi-pencil" class="mr-6" pTooltip="Edit Product"
                                (onClick)="editProduct(product)"
                                styleClass="p-button-rounded p-button-outlined"></p-button>
                            <p-button icon="pi pi-trash" class="mr-6" pTooltip="Delete Product"
                                (onClick)="deleteProduct(product)"
                                styleClass="p-button-rounded p-button-outlined"></p-button>
                        </ng-container>
                    </div>
                </p-accordionTab>
            </ng-container>
        </p-accordion>
    </ng-container>
</ng-template>
